version: 2 
jobs: 
  docker-image-build:
    docker: 
      # DLC does nothing here, its caching depends on commonality of the image layers.
      - image: circleci/ruby:latest
    steps: 
      - checkout 
      - setup_remote_docker: 
        docker_layer_caching: true 
      # DLC will explicitly cache layers here and try to avoid rebuilding.
      - run: rake docker
  debug-qemu-build: 
    docker: 
      # DLC does nothing here, its caching depends on commonality of the image layers.
      - image: circleci/ruby:latest
    steps: 
      - checkout 
      - setup_remote_docker: 
        docker_layer_caching: true 
      # DLC will explicitly cache layers here and try to avoid rebuilding.
      - run: rake debug:build_qemu
     
workflows:
  pseudo-oe:
    jobs:
      - debug-qemu-build
        requires:
          - docker-image-build